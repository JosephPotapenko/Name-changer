<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rename Files in Folder</title>
</head>
<body>
  <h2>Rename Files in Folder</h2>

  <label for="removeString">Remove this text from file names:</label>
  <input type="text" id="removeString" placeholder="Enter string to remove" />

  <br><br>

  <input type="file" id="folderInput" webkitdirectory multiple />
  <button onclick="processFiles()">Rename and Download</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    async function processFiles() {
      const removeText = document.getElementById('removeString').value;
      const files = document.getElementById('folderInput').files;
      if (!files.length) {
        alert("Please select a folder.");
        return;
      }

      const zip = new JSZip();

      for (let file of files) {
        // Strip the prefix string from the filename only
        const originalName = file.webkitRelativePath;
        const folderPath = originalName.substring(0, originalName.lastIndexOf("/") + 1);
        const baseName = file.name;
        const newName = baseName.replace(removeText, '');

        const content = await file.arrayBuffer();
        zip.file(folderPath + newName, content);
      }

      // Create the ZIP file and download
      zip.generateAsync({ type: "blob" }).then(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "renamed_files.zip";
        a.click();
      });
    }
  </script>
</body>
</html>
